<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
      .hidden {
        display: none;
      }
  
      #card_1,
      #card_2,
      #card_3,
      #card_4,
      #card_5,
      #card_6 {
        position: fixed;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 150px;
        height: 200px;
        background-color: aliceblue;
        padding: 20px;
        align-items: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        z-index: 10;
      }
  
      .dialog span.hidden {
        visibility: hidden;
      }
    </style>
  </head>
  <body>
    <a-scene mindar-image="imageTargetSrc: assets/targets.mind;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-assets>
        <a-asset-item id="test_boy" src="assets/results.jpg"></a-asset-item>
        <a-asset-item id="test_girl" src="assets/0523.jpg"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity id="targetA" mindar-image-target="targetIndex: 0">
        <div id="card_1" class="hidden clickable">
          <div id="scene1" class="hidden" src="#test_boy">
            <img src="assets/results.jpg" alt="">
            <p class="dialog">這是新目標圖的對話內容。歡迎來到新場景！</p>
          </div>
        </div>
      </a-entity>
      <a-entity id="targetB" mindar-image-target="targetIndex: 1">
        <div id="card_2" class="hidden clickable">
          <div id="scene2" class="hidden" src="#test_girl">
            <p class="dialog">這是新目標圖的對話內容。歡迎來到新場景！</p>
          </div>
        </div>
      </a-entity>
    </a-scene>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
      const sceneEl = document.querySelector('a-scene');
      let arSystem;

      sceneEl.addEventListener('loaded', function () {
        console.log('AR scene loaded');
        arSystem = sceneEl.systems["mindar-image-system"];

        const targetA = document.querySelector("#targetA");
        const targetB = document.querySelector("#targetB");

        targetA.addEventListener("targetFound", async event => {
          console.log('target A found');
          document.getElementById('scene1').classList.remove('hidden');
          document.getElementById('card_1').classList.remove('hidden');
          // await playMusic('assets/firstdia.wav');
        });

        targetA.addEventListener("targetLost", event => {
          console.log('target A lost');
          document.getElementById('card_1').classList.add('hidden');
          document.getElementById('scene1').classList.add('hidden');
          // pauseMusic();
        });

        targetB.addEventListener("targetFound", async event => {
          console.log('target B found');
          // document.getElementById('scene4').classList.remove('hidden');
          // document.getElementById('card_4').classList.remove('hidden');
          // await playMusic('assets/secondaudio.wav');
        });

        targetB.addEventListener("targetLost", event => {
          console.log('target B lost');
          // document.getElementById('card_4').classList.add('hidden');
          // document.getElementById('scene4').classList.add('hidden');
          // pauseMusic();
        });
      });

      const card1 = document.getElementById('card_1');
      card1.addEventListener("click", event => {
        console.log('card_1 clicked');
        document.getElementById('card_1').classList.add('hidden');
        document.getElementById('scene1').classList.add('hidden');
        document.getElementById('card_2').classList.remove('hidden');
        document.getElementById('scene2').classList.remove('hidden');
        // pauseMusic();
      });
    }); 
    </script>
  </body>
</html>